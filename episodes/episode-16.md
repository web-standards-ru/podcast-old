# Выпуск №16

Экономия батареи, оптимизация графики, прозрачность в HEX, !important можно, таблицы, полифилы.

[Слушайте на SoundCloud](https://soundcloud.com/web-standards/episode-16), [обсуждайте в Слаке](https://web-standards.slack.com/messages/podcast/).

00:15 События

- [Лог трансляции с CSSConf в Будапеште](https://github.com/web-standards-ru/web-standards-up/blob/master/2016-05-11_cssconfbudapest.md)
- [WSD в Екатеринбурге 25 июня](https://wsd.events/2016/06/25/)
- [FrontendFellows в Перми 27 мая](https://frontendfellows.timepad.ru/event/299132/)
- [FrontendFellows в Астане 29 июля](https://frontendfellows.timepad.ru/event/328848/)
- [Rolling Scopes Summer Summit в Минске 4 июня](https://minsk.rollingscopes.com/)
- [Видео с PiterCSS №3](https://youtu.be/24EZOgySNRI?list=PLMBnwIwFEFHeDVHZJw7Y5WWVkAb1O_OwC)

03:39 Как браузеры экономят батарейку

- [Introducing power saving mode in Opera](https://www.opera.com/blogs/desktop/2016/05/introducing-power-saving-mode/)

16:50 Оптимизация графики

- [Reducing JPG File size](https://medium.com/p/e5b27df3257c)
- [ImageAlpha](https://pngmini.com/)
- [Can I Use: WebP](http://caniuse.com/webp)
- [APNG](https://wiki.mozilla.org/APNG_Specification)
- [MozJPEG](https://github.com/mozilla/mozjpeg)

33:44 Прозрачность в HEX-цветах

- [RGBA и RRGGBBAA в Firefox 49](http://codepen.io/malyw/pen/wGNOrd?editors=1100)
- [Color in Opera 10 — HSL, RGB and Alpha Transparency](https://dev.opera.com/articles/hsl-rgb-and-alpha-transparency/)

43:06 !important можно, если нужно

- [The Importance of `!important`: Forcing Immutability in CSS](http://csswizardry.com/2016/05/the-importance-of-important/)
- [Likely](https://github.com/ilyabirman/Likely)

48:27 Фантомные страхи и адаптивные таблицы

- [CSS only Responsive Tables](http://dbushell.com/2016/03/04/css-only-responsive-tables/)
- [Accessible, Simple, Responsive Tables](https://css-tricks.com/accessible-simple-responsive-tables/)

52:06 Полифил через юзер-агент

- [Polyfill.io](https://cdn.polyfill.io/)


---

**Вадим.** Привет, с вами 16-й выпуск подкаста «Веб-стандарты» и его постоянные ведущие: Алексей Симоненко из HTML Академии.

**Лёша.** И Вадим Макеев из Оперы

**Вадим.** А Ольги Алексашенко - верстальщика руками, сегодня с нами нет. У Ольги бал. Поэтому она занята.


## 00:15 События

**Вадим.** На этой неделе было много новостей по всяким событиям, а новостей по технологиям, по всяким браузерным новинкам, наверное было меньше обычного, все-таки приближается лето. Но, давайте поговорим про события. На этой неделе была текстовая трансляция с CSS Conf в Будапеште. Мы уже выложили log в нашем репозитории на github и там довольно много интересного, ссылки, всякие фоточки, и вы можете почувствовать как будто практически съездили на этот CSS Conf в Будапешт. Довольно дешево для вас, просто открыть страничку. 
Если вы будете сами на каких-нибудь конференциях, ваших локальных встречах,  какие-нибудь митапы по чему угодно, около фронтендные, пишите нам, мы с удовольствием дадим вам ключи от нашего уютного твиттера и вы сможете устроить там текстовую трансляцию сами.  
На этой неделе мы анонсировали WSD в Екатеринбурге. Он пройдет 25 июня и мы ищем докладчиков. Пока на странице особо ничего нет, но есть регистрация, поэтому регистрируйтесь, а мы, я думаю, в понедельник-вторник анонсируем первых докладчиков и расскажем подробней про события.

WSD в Екатеринбурге немножко не традиционно проходит в июне. А мы, обычно, в июне проводим Питерский WSD. Наверное мы проведем его в конце лета, начале осени, а в этот раз нам ребята из FrontendFellows и СКБ контур предложили сделать WSD в Екатеринбурге и мы сказали, а почему бы и нет.

Летом, я думаю, там будет хорошо и интересно.  FrontendFellows сами проводят мероприятия регулярно и вот 27 мая будет в Перьми их очередная встреча и 29 июля они поедут в Астану. Это будет первый FrontendFellows за пределами России и, по-моему, первое крупное мероприятие по фронтенду в Казахстане. Поэтому я немножко завидую ребятам и надо будет как-нибудь приехать с WSD в Казахстан. Зовите.

Еще в Минске 4 июня пройдет Rolling Scopes Summer Summit, тоже такая встреча регулярная с громким названием Summit. Я давно хочу съездить на конференцию Roolling Scopes, но вот не получается. Может как-нибудь загляну на Summit в Минске. В Минске тоже хорошо.   
Еще смонтировали видео с Piter CSS №3 на этой неделе. Немножко поздновато, но лучше поздно, чем никогда, правда? И там, в общем-то, был доклад, который большинство из вас заинтересовал, как Слава Шабанов рассказывал про фронтенд ВКонтакте. Поэтому, если вы еще не добрались и не посмотрели, посмотрите.

Очень много хитеров пришло, очень много всяких забавных комментариев, но главный плюс этого доклада в том, что он довольно откровенный, честный и, по-моему, интересный. Интересно посмотреть на то, как большие проекты разрабатываются, как они организованы и вообще. 

Фронтенд, на самом деле, кажется скучным и маленьким со стороны, но он довольно сложный. Там Слава рассказывает как он, для того, чтобы компилировать CSS, поднимал кластеры на node.js, в общем, забавно.

Ну и PiterCSS №4 мы проведем где-нибудь в конце мая, наверное, потом прервемся на каникулы. Дату мы анонсируем, я думаю, на днях, так что присылайте ваши заявки, у нас есть еще места для докладов на PiterCSS №4. Дизайн, стили, типографика, вот все вот это, можем даже немножко JS, хотя знаете, наверное не стоит.


## 03:39 Как браузеры экономят батарейку        

**Лёша.** Как Вадим уже сказал, на этой неделе было не  очень много статей про технологии, но, тем не менее, какая-то их часть была. Наверное, уже традиционно, начнем мы с Opera. Ну, почему бы и нет.

**Вадим.** Ну, да, у нас выпуски иногда превращаются в такую викторину: “Спроси у Opera”. Алеша задает каверзные вопросы, а я выкручиваюсь. Наверное сегодня тоже самое будет, да?

**Лёша.** Давай попробуем. Ведь статью про то, что в Opera появился режим сохранения батареи, явно писали маркетологи. Поэтому у меня есть несколько вопросов.

**Вадим.** Например?

**Лёша.** Ну, смотри. Меня немножко смутило то, что там сразу в первом абзаце было заявление о том, что Opera это первый браузер, которая занялась оптимизацией расхода батареи. И мне показалось это немножко лукавством. Потому что, ведь это не так. Тот же самый Safari, и ты об этом когда-то говорил, он очень хорошо работает с сохранением батареи, отключает кучу вещей, отключает многие штуки даже если окно перекрывается. Они тоже этим занимаются и поэтому мне показалось небольшое лукавство, но возможно, там есть под капотом что-то более интересное.

**Вадим.** Ну, в общем-то, все браузеры пытаются экономить энергию, потому что это важная штука, если вы анонсировали, что у вас железка живет 12 часов, а потом пользователь открывает браузер, одну из самых популярных программ, и никаких 12 часов не получается,  получается 2 часа, естественно, вы будете врать пользователям. И одной из самых больших проблем всегда в браузере были сторонние плееры, всякие flash-плееры и silverlight, в общем плагины, которые воровали убивали, а в итоге пользователи винили браузер. Когда плагины практически ушли, у меня на Macbook не стоит никакого Flash очень давно и у меня нет встроенного flash в Opera, поэтому мне регулярно сайты показывают вместо рекламы: “Установите Flash-плеер”, так приятно. Так вот сейчас эта проблема ушла. Сейчас есть другая проблема. Браузеры, с одной стороны, пытаются рендерить страницу очень быстро и очень круто. Показывать плавную анимацию 60 frames per secound и так далее и так далее. С другой стороны им нужно экономить батарейку. И вот, когда вы подключены к вашей розетке в стене, действительно, браузеры могут делать что хотят, потому что электричество дешевое. Вот, когда вы в дороге, электричество становится для вас дорогим, потому что вы хотите, чтобы ваша батарейка прожила дольше. И можно делать разные вещи. Можно, допустим, фоновые вкладки не загружать, когда вы только что открыли браузер. Можно, допустим, останавливать анимацию, можно останавливать видео. Такие базовые вещи делают все.

Мы пошли немножко дальше и поэтому решили поговорить об этом, потому что это не просто какой-то маркетинговый трюк, а там немножко есть веб-технологий. 

Что мы делаем. Мы замедляем некоторую анимацию, trotling так называемый, некоторые части. Допустим, где-то там 60 fps, а мы снижаем их до 30 fps. Это экономит очень много энергии. И не только в фоновых вкладках. Когда вы на текущей странице что-то делаете, мы замедляем некоторые вещи, если понимаем, что вы не подключены к розетке. Мы немножко меняем поведение браузеров. Когда вы заходите на Youtube, а Youtube вам говорить привет. Вы ему отправляете какие-то заголовки, ваш браузер отправляет заголовки, в которых вы говорите какие видео форматы вы поддерживаете. И смотрите, если у вас есть аппаратная поддержка кодека H-264, соответственно аппаратный рендеринг гораздо эффективней с точки зрения энергии, чем софтверный рендеринг, поэтому, когда вы поддерживаете H-264 аппаратно, Youtube может посылать вам это видео, но он предлагает вместо h-264 VP8-кодек. Он лучше сжимается, но он более энерго потребляющий. Соответственно, с точки зрения вашей батарейки, лучше бы он вам отправил видео в H-264. Но Youtube, с точки зрения трафика, посылает вам VP8. И мы такие говорим: “А мы VP8 не поддерживаем,  присылай нам H-264”. И таким образом экономим вашу батарейку, немножко привирая сайтам, что мы на самом деле поддерживаем. 

И там есть еще другие трюки. Там, на самом деле, довольно большой список. И как это произошло. Мы просто посмотрели на средние страницы, посмотрели, куда утекает батарейка, в какие дырки, и позатыкали те дырки, но постарались, естественно, не сломать страницы.
Мы конечно еще экспериментируем с этой штукой. Она в девелопер канале. Мы будем смотреть, не ломается ли что либо. Но опять же, мы делаем это не для того, чтобы навредить вам, дорогие разработчики, а для того, чтобы пользователи были довольны и у них батарейка длилась как обещано. Но так уж получилось что мы, приняв архитектуру проекта Chromium, вынуждены были принять и некоторые другие решения. Как то: многопоточность, каждая вкладка в отдельном процессе, какая-то прожорливость к памяти и так далее. Presta был в этом смысле эффективнее, чем Chromium, но Chromium и может больше и развивается быстрее и с точки зрения веб-технологий лучше. Поэтому, да, мы жрем батарейку, но мы делаем это не просто так и сейчас думаем о том, как бы все это дело улучшить. Т.е. не просто сохраняем батарею, а стараемся делать хитрее, как мы это уже делаем с трафиком, в ситуации с Opera Mini, с ситуацией с Opera Turbo, когда мы немножко подменяем трафик, немножко пытаемся сделать вещи, которые не так важны. 

**Лёша.** Звучит, конечно, здорово, но у меня такой вопрос к тебе, может быть к вашим маркетологам. Может быть вы выпустите потом еще статью? Вот у вас в статье был хороший тест. Вы тестировали Chrome и Opera. И показали, как вы это делаете, показали на каком оборудовании вы это делаете и, в общем, показали результаты. Это, вроде бы, хорошо, но Chrome специально этим не занимается, сохранением энергии батареи. Почему бы вам не сравнить себя с Safari в похожем режиме? Мне даже самому было бы интересно, на сколько это лучше или хуже, потому что Safari правда очень хорошо сохраняет батарею. Когда совсем уже плохо, на ноутбуке нет энергии, там вообще уже вся система, по-моему, начинает сохранять батарею. И я понимаю, что сравнение с Safari, это только маленькая часть вашего рынка, потому что Opera работает и на Windows и, как я понимаю, сохраняет батарею она также и на Windows, правильно ведь?

**Вадим.** Да, это не просто Mac-фишечка.

**Лёша.** Это было бы более интересно, сравнить два браузера, которые занимаются этим, чем сравнивать браузер, который не занимается этим, с браузером, который этим занимается. Выигрыш понятен.

**Вадим.** Смотри. На самом деле Chromium тоже этим занимается. Ребята из Google тоже этим занимаются, энергоэффективностью. Потому что они в курсе, что у Chrome, по сравнению с другими браузерами память течет больше, прожорливость выше. Но мы сравнивали с Chrome потому что работаем на одной платформе. Можно было еще с Links сравнить, который текстовый браузер. Да, наверное, честнее было бы сделать что-то большое, более серьезное исследование. Но это блог opera.com/blogs, он более такой, для пользователей. Если бы это был большой пост в какой-нибудь arstechnica.com/ или еще где-нибудь, там нужно было бы серьезное сравнение, экспертов пригласить. Но это немножко другая история. Мы не пытаемся доказать всем разработчикам софта, всем технологическим гуру, что мы лучше. Мы пытаемся сделать продукт для пользователя лучше. Поэтому это было такое легкое маркетинговое исследование. Мы не наврали, но мы не углубились достаточно сильно.

**Лёша.** В плане пользователей это и правда им удобно, потому что, как я понял, как я прочитал, этот режим автоматически включается, когда  батарейка уже садится. 

**Вадим.** Да-да-да. Смотри. Safari экономит батарейку всегда, на сколько я понимаю. Возможно, она берет из системы информацию о том, что мы не на питании, а на батареи и как-то оптимизирует, но они об этом не рассказывают. Apple известны тем, что “браузер просто работает”, “ноутбук просто работает”, “ой, завис”. Зато до этого просто работал. Поэтому тоже самое с браузером. Может они оптимизируют что-то. Пусть расскажут. Мы с удовольствием посоревнуемся с ними. Наша открытость, мне кажется, играет на нас, мы выглядим симпатичней.

**Лёша.** Ну, это правда. У меня сейчас почему-то в голову вопрос влез. Раньше Opera славилась тем, что это был большой комбайн. В нем было много разных фич и кто-то Opera именно за это выбрал, кто-то по этой причине не хотел выбирать Opera, но это была такая отличительная особенность. Это браузер в котором было очень много всего. А потом вы это все отрезали, перейдя на Chromium, и сейчас последовательно начинаете добавлять фичу за фичей. И понятно, вы делаете это для удобства, для пользователей, с какой-то идеей, но, тем не менее, браузер так начинает все больше и больше пухнуть. В любом случае, какая бы это хорошая фича не была, их становится много. Это также как Firefox, если ты помнишь, когда он только начинался, там была версия 1.5, 2, там идеальный браузер был. Он был просто невероятно быстрый, молниеносный, хороший. А потом с каждой версией в нем стала появляться какая-то дополнительная фича. Сейчас это монстр, которым пользоваться тяжело. Не боитесь, что вот это  может завести опять к тому времени, когда Opera была комбайном? Не то, чтобы это плохо, может это вернет какую-то часть аудитории, которой это нравилось, но вот что думаешь об этом? Не страшно?

**Вадим.** Можно это делать по разному. Смотри. Когда Opera была комбайном, она была комбайном с реактивными двигателями и прицепленными по бокам двумя ресторанами. Потому что, когда у тебя в браузере интегрирован почтовый клиент, торент-клиент, arc-чат, еще что-то такое, это совсем не то, когда у тебя висит какая-то штучка, которая определяет подключена у тебя батарейка или нет или какая-нибудь маленькая прокси, которая блокирует рекламу просто на уровне сетевых запросов. Это совсем не то. Мы не пытаемся вернуть аудиторию, которой нравился комбайн. Мы не пытаемся конкурировать с Vivaldi в этом смысле. Потому что у них то как раз все, что можно написать, будет написано и внедрено. А почему? Ну, потому что можем. Мы пытаемся сделать такие консьюмерские, пользовательские штучки, которые на самом деле просто работают. В большинстве случаев, нужно просто нажать кнопочку или она нажимается за вас, если это фича, которая сильно нужна. Многие из них - эксперименты. Я думаю, часть из них уйдет. У нас, долгое время есть такая фича как Turbo и она спрятана где-то далеко за меню и она не включается по-умолчанию. Тем, кому это нужно, ее включают. По-умолчанию она не мешает, она в глаза не лезет. Наверное, также фичи будут все остальные. По-умолчанию, когда у нас появилась синхронизация, у нас на панели торчала иконка синхронизации и мозолила глаза. Сейчас она исчезает, когда вы авторизовались и все нормально. Фичи будут появляться, пользовательские, потому что это хороший способ конкурировать. А, поскольку у нас нет своей операционной системы, у нас нет какого-нибудь другого мощного канала дистрибуции, который бесплатно дает кучу пользователей, мы должны показывать, что мы лучше и умеем что-либо.

С точки зрения  Firefox у них немножко другая проблема. Они все эти фичи делали медленными в браузере, потому что многие из них были реализованы на слишком гибких технологиях. Там тот же самый KSU, те же расширения,  которые были легче, чем KSU, но слишком мощные. Мы вещи пишем все нативно. Берем и на C пишем фичу и внедряем ее, компилируем. Т.е. это получается не какое-то расширение, вставочки или какая-то непонятная штука. А вещь, которая работает нативно, как софт. И не тормозит.

